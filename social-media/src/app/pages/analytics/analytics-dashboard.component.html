<div class="analytics-container">
  <div class="analytics-header">
    <div class="header-left">
      <lucide-angular [img]="chartIcon" class="header-icon"></lucide-angular>
      <div>
        <h1>Analytics Dashboard</h1>
        <p class="subtitle">Track your performance and engagement</p>
      </div>
    </div>

    <!-- Global Date Range Selector -->
    <div class="header-actions">
      <div class="period-selector">
        @for (period of periods; track period) {
          <button
            class="period-btn"
            [class.active]="selectedPeriod() === period"
            (click)="setPeriod(period)"
          >
            {{ period }}
          </button>
        }
      </div>
      <button class="refresh-btn" (click)="refreshAll()" [class.loading]="isLoading()">
        <lucide-angular [img]="refreshIcon" [size]="18"></lucide-angular>
      </button>
    </div>
  </div>

  @if (hasError()) {
    <div class="error-state">
      <div class="error-content">
        <lucide-angular [img]="alertIcon" class="error-icon"></lucide-angular>
        <h3>Failed to load analytics</h3>
        <p>Something went wrong while loading your analytics data.</p>
        <button class="retry-btn" (click)="refreshAll()">
          <lucide-angular [img]="refreshIcon" [size]="16"></lucide-angular>
          Try Again
        </button>
      </div>
    </div>
  } @else {
    <!-- Analytics Overview Cards -->
    <app-analytics-overview-cards
      [period]="selectedPeriod()"
      [clickable]="true"
      (cardClick)="onCardClick($event)">
    </app-analytics-overview-cards>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <app-follower-growth-chart [initialPeriod]="selectedPeriod()"></app-follower-growth-chart>
      <app-engagement-breakdown-chart [initialPeriod]="selectedPeriod()"></app-engagement-breakdown-chart>
    </div>

    <!-- Top Posts Section -->
    <app-top-posts-section [initialPeriod]="selectedPeriod()"></app-top-posts-section>
  }
</div>
