<div class="feed-container">
  <aside class="sidebar-left">
    <div class="quick-links">
      <h3>Trending</h3>
      @for (tag of searchService.getTrendingHashtags().slice(0, 5); track tag.tag) {
        <a class="link-item" [routerLink]="['/hashtag', tag.tag]">
          <lucide-icon [img]="hashtagIcon"></lucide-icon>
          <span>#{{ tag.tag }}</span>
        </a>
      }
    </div>
  </aside>

  <div class="feed-column" appInfiniteScroll (scrolled)="onLoadMore()">
    <!-- Refresh Indicator -->
    <app-refresh-indicator
      [show]="showRefreshIndicator"
      (refresh)="onRefresh()"
      (dismiss)="onDismissNewPosts()">
    </app-refresh-indicator>

    @if (isLoading()) {
      <div class="create-post-skeleton">
        <div class="skeleton-header">
          <app-skeleton variant="avatar" width="40px" height="40px"></app-skeleton>
          <app-skeleton variant="text" width="200px" height="40px"></app-skeleton>
        </div>
        <app-skeleton variant="text" width="100%" height="80px"></app-skeleton>
      </div>
    } @else {
      <app-create-post></app-create-post>
    }

    <div class="threads-container">
      @if (isLoading()) {
        @for (item of [1, 2, 3]; track item) {
          <app-post-skeleton></app-post-skeleton>
        }
      } @else {
        @for (post of posts(); track post.id) {
          <app-post-card
            [post]="post"
          ></app-post-card>
        }
      }
    </div>

    <!-- Loading Indicator -->
    <app-loading-indicator [visible]="isLoadingMore()"></app-loading-indicator>

    <!-- End of Feed Message -->
    @if (!isLoading() && !hasMorePosts() && posts().length > 0) {
      <div class="end-of-feed">
        <p>You're all caught up!</p>
        <span>No more posts to show</span>
      </div>
    }
  </div>

  <aside class="sidebar-right">
    <div class="suggestions-card">
      <h3>Suggestions For You</h3>
      @for (u of searchService.getSuggestedUsers(5); track u.username) {
        <a class="suggestion-item" [routerLink]="['/profile', u.username]">
          <div class="suggestion-left">
            <img [src]="u.avatar_url" [alt]="u.display_name" />
            <div class="suggestion-info">
              <p class="suggestion-name">{{ u.display_name }}</p>
              <p class="suggestion-handle">&#64;{{ u.username }}</p>
            </div>
          </div>
        </a>
      }
    </div>
  </aside>
</div>
